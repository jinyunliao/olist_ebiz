version: '3.8'
services:
  superset:
    image: apache/superset:latest
    ports:
      - "8088:8088"
    depends_on:
      - postgres
    environment:
      # Use the project's Postgres container as a demo datasource
      - SUPERSET_DATABASE_URL=postgresql://dbt:dbt@postgres:5432/analytics
      - SUPERSET_LOAD_EXAMPLES=yes
    command: /bin/bash -lc "superset db upgrade && superset fab create-admin --username admin --firstname Admin --lastname User --email admin@example.com --password admin || true && superset init && superset run -p 8088 --with-threads --reload --debugger"
